\documentclass[brazil,ruledheader]{abnt}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}

\usepackage{palatino}
\usepackage {graphicx}
\usepackage{babel}
\usepackage{setspace}
%\usepackage{hyperref}
\usepackage {fancyvrb}
\usepackage{color}
\usepackage{textcomp}
\usepackage{subfigure}
\usepackage{listings}

\makeatletter
\makeatother

\definecolor{light-gray}{gray}{0.6}

\begin{document}
\renewcommand{\lstlistlistingname}{Lista de Listagens}
\renewcommand{\lstlistingname}{Listagem}

\autor{Fausto Guzzo da Costa \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nUsp: 5230736\\ Filipe Del Nero Grillo \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nUsp: 5378140 \\ Vinicíus Augusto Tagliatti Zani \ \ \ \ \ \ \ nUsp: 5118935}


\titulo{Avaliação de Sistemas de Arquivos \\  \normalsize \textcolor{light-gray}{(Ext4, ReiserFS e XFS)}}



\comentario{Monografia apresentada para conclusão da disciplina de Sistemas Operacionais da pós-graduação do ICMC-USP em 2011}


\instituicao{Instituto de Ciências Matemáticas e de Computação \par Universidade
de São Paulo \par ICMC - USP
}

\local{São Carlos - SP, Brasil}


\data{20 de junho de 2011}

\capa

\folhaderosto

\begin{folhadeaprovacao}
\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\\ \\
\begin{flushright}{}``\emph{Por mais humilde que seja, um bom}\\
\emph{trabalho inspira uma sensação de vitória.}\\
{\small Jack Kemp}\end{flushright}{\small \par}
\end{folhadeaprovacao}

\begin{resumo}
\doublespacing

resumo aqui!

\end{resumo}


\tableofcontents{}
\listadefiguras
\listadetabelas
\lstlistoflistings

\chapter{Introdução}\label{cap:introducao}

	
\section{Contexto e Motivação}\label{sec:contexto}

		
\section{Objetivos}\label{sec:objetivos}


\section{Organização do trabalho}\label{sec:organizacao}


\chapter{Metodos e Ferramentas}\label{cap:metodos}

\section{XFS}\label{sec:xfs}

\section{Ext4}\label{sec:ext4}

\section{ReiserFS}\label{sec:reiser}

O ReiserFS foi criado em 1996 por Hans Thomas Reiser e se tornou muito famoso, entre outras coisas, por ser o primeiro sistema de arquivos a utilizar a técnica de \textit{journaling} para melhorar a confiabilidade do sistema. No caso do ReiserFS, o \textit{journaling} embora sejam guardadas informações sobre todo o sistema de arquivos, ele tem a intenção de garantir a integridade dos metadados dos arquivos, ou seja, ele não é capaz de reconstruir todo o sistema de arquivos a partir do \textit{journal}.

Passou a ser suportado oficialmente pelo kernel do linux a partir de sua versão 2.4 e chegou a ser adotado como sistema de arquivos padrão da distribuição comercial da Novell, o SUSE Linux Enterprise. Sua adoção foi baseada no fato do Reiser ser o único sistema de arquivos da época que possuia \textit{journaling} e também em acordos de suporte com a empresa de de seu criador a Namesys.

Este sistema utiliza árvores B* para melhorar o desempenho em operações de busca. De acordo com a documentação encontrada sobre o sistema \cite{site reiser} ele pode ser utilizado com quatro opções de tamanho de bloco: 4096 (padrão), 512, 1024 e 8192 KBytes. No entanto, durante testes preliminares com o sistema Kubuntu 10.10 não foi possível criar um sistema de arquivos Reiser com tamanho de bloco diferente de 4096 KBytes.

XXX Colocar um dump do terminal falando que não é possível utilizar outra opção de bloco.

Á estrutura de árvore utilizada possui dois tipos de nós: Nós internos e nós folhas e cada nó é um bloco do disco. O primeiro tipo é utilizado para manter a estrutura de árvore, apontando para outros blocos. Os nós folha são os itens propriamente ditos. No ReiserFS os itens podem representar arquivos, diretórios ou \textit{stat item}. Os arquivos podem ser de dois tipos, itens diretos ou indiretos, dependendo do tamanho do arquivo.

Cada diretório ou arquivo é sempre precedido por um \textit{stat item} que contém metadados sobre o arquivo ou diretório que o sucede.

A Figura \ref{fig:reisertree} mostra um exemplo da estrutura de árvore utilizada pelo ReiserFS para organizar os arquivos no disco.

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/stree.png}
\caption {Modelo de árvore utilizado pelo ReiserFS com blocos internos representados pelos blocos retangulares e blocos folha representados por esferas.}
\label{fig:reisertree}
\end{center}
\end{figure}

Principais vantagens:
\begin{itemize}
	\item vantagem 1
	\item vantagem 2
\end{itemize}

Principais desvantagens:
\begin{itemize}
	\item desvantagem 1
	\item desvantagem 2
\end{itemize}

\section{IOzone}\label{sec:iozone}

\section{Avaliação de desempenho}\label{sec:avaliacao}

\section{Ambiente}\label{sec: ambiente}


\chapter{Planejamento e execução}\label{cap:planejamento}

\section{Variáveis de resposta, fatores e níveis}\label{sec:fatores}

\section{Experimentos}\label{sec:experimentos}

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Experimento} & \textbf{A} & \textbf{B} & \textbf{C} & \textbf{D} \\ \hline
\textbf{1} & 1 & 1 & 1 & 1 \\ \hline
\textbf{2} & 1 & 1 & 1 & -1 \\ \hline
\textbf{3} & 1 & 1 & -1 & 1 \\ \hline
\textbf{4} & 1 & 1 & -1 & -1 \\ \hline
\textbf{5} & 1 & -1 & 1 & 1 \\ \hline
\textbf{6} & 1 & -1 & 1 & -1 \\ \hline
\textbf{7} & 1 & -1 & -1 & 1 \\ \hline
\textbf{8} & 1 & -1 & -1 & -1 \\ \hline
\textbf{9} & -1 & 1 & 1 & 1 \\ \hline
\textbf{10} & -1 & 1 & 1 & -1 \\ \hline
\textbf{11} & -1 & 1 & -1 & 1 \\ \hline
\textbf{12} & -1 & 1 & -1 & -1 \\ \hline
\textbf{13} & -1 & -1 & 1 & 1 \\ \hline
\textbf{14} & -1 & -1 & 1 & -1 \\ \hline
\textbf{15} & -1 & -1 & -1 & 1 \\ \hline
\textbf{16} & -1 & -1 & -1 & -1 \\ \hline
\end{tabular}
\caption{Níveis utilizados em cada um dos experimentos para a Etapa 1}
\end{center}
\label{etapa1_experimentos}
\end{table}

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\textbf{Experimento} & \textbf{A} & \textbf{C} & \textbf{D} \\ \hline
\textbf{1} & 1 & 1 & 1 \\ \hline
\textbf{2} & 1 & 1 & -1 \\ \hline
\textbf{3} & 1 & -1 & 1 \\ \hline
\textbf{4} & 1 & -1 & -1 \\ \hline
\textbf{5} & -1 & 1 & 1 \\ \hline
\textbf{6} & -1 & 1 & -1 \\ \hline
\textbf{7} & -1 & -1 & 1 \\ \hline
\textbf{8} & -1 & -1 & -1 \\ \hline
\end{tabular}
\caption{Níveis utilizados em cada um dos experimentos para as Etapa 2 e 3}
\end{center}
\label{etapa2e3_experimentos}
\end{table}



\chapter{Resultados Obtidos}\label{cap:resultados}

\section{Etapa 1: }\label{sec:etapa1}

  \begin{table}[htbp]
\begin{center}
\begin{tabular}{|l|r|r|r|r|}
\hline
\multicolumn{1}{|l|}{\textbf{Fator(es)}} & \multicolumn{1}{l|}{\textbf{Write}} & \multicolumn{1}{l|}{\textbf{Read}} & \multicolumn{1}{l|}{\textbf{Random Read}} & \multicolumn{1}{l|}{\textbf{Random Write}} \\ \hline
\textbf{iA} & 6.00 & 0.44 & 28.97 & 1.15 \\ \hline
\textbf{iB} & 77.29 & 1.82 & 0.02 & 0.29 \\ \hline
\textbf{iC} & 0.01 & 0.11 & 26.29 & 68.52 \\ \hline
\textbf{iD} & 11.27 & 64.16 & 35.92 & 28.06 \\ \hline
\textbf{iAB} & 1.94 & 4.86 & 0.50 & 0.11 \\ \hline
\textbf{iAC} & 0.11 & 10.86 & 7.35 & 0.16 \\ \hline
\textbf{iAD} & 0.19 & 0.13 & 0.00 & 0.45 \\ \hline
\textbf{iBC} & 0.00 & 3.03 & 0.09 & 0.14 \\ \hline
\textbf{iBD} & 2.74 & 5.25 & 0.15 & 0.05 \\ \hline
\textbf{iCD} & 0.01 & 0.06 & 0.14 & 0.88 \\ \hline
\textbf{iABC} & 0.25 & 2.04 & 0.03 & 0.01 \\ \hline
\textbf{iABD} & 0.06 & 5.05 & 0.23 & 0.11 \\ \hline
\textbf{iACD} & 0.12 & 2.07 & 0.11 & 0.05 \\ \hline
\textbf{iBCD} & 0.01 & 0.04 & 0.15 & 0.01 \\ \hline
\textbf{iABCD} & 0.00 & 0.09 & 0.03 & 0.01 \\ \hline
\end{tabular}
\caption{Tabela com os valores calculados de influência dos fatores para a Etapa 1 da avaliação de desempenho separados para o tipo de operação.}
\end{center}
\label{tab:influ1}
\end{table}


\begin{figure}[ht]
\centering
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa1_write.png}
\label{fig:influ1_write}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa1_read.png}
\label{fig:influ1_read}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa1_randread.png}
\label{fig:influ1_randread}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa1_randwrite.png}
\label{fig:influ1_randwrite}
}
\label{fig:etapa1_influs}
\caption{Gráficos com as influências dos fatores calculadas para as operações avaliadas na Etapa 1: \subref{fig:influ1_write} - Escrita, \subref{fig:influ1_read} - Leitura, \subref{fig:influ1_randread} - Leitura aleatória e \subref{fig:influ1_randwrite} - Escrita aleatória}
\end{figure}



\section{Etapa 2: }\label{sec:etapa2}

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|l|r|r|r|r|}
\hline
\multicolumn{1}{|l|}{\textbf{Fator(es)}} & \multicolumn{1}{l|}{\textbf{Write}} & \multicolumn{1}{l|}{\textbf{Read}} & \multicolumn{1}{l|}{\textbf{Random Read}} & \multicolumn{1}{l|}{\textbf{Random Write}} \\ \hline
\textbf{iA} & 84.93 & 22.67 & 3.49 & 0.08 \\ \hline
\textbf{iC} & 1.32 & 1.32 & 16.17 & 56.45 \\ \hline
\textbf{iD} & 8.55 & 49.85 & 68.35 & 43.08 \\ \hline
\textbf{iAC} & 0.09 & 1.60 & 1.79 & 0.14 \\ \hline
\textbf{iAD} & 4.57 & 23.98 & 4.81 & 0.01 \\ \hline
\textbf{iCD} & 0.13 & 0.09 & 1.70 & 0.25 \\ \hline
\textbf{iACD} & 0.41 & 0.49 & 3.69 & 0.00 \\ \hline
\end{tabular}
\caption{Tabela com os valores calculados de influência dos fatores para a Etapa 2 da avaliação de desempenho separados para o tipo de operação.}
\end{center}
\label{tab:influ2}
\end{table}


\begin{figure}[ht]
\centering
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa2_write.png}
\label{fig:influ2_write}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa2_read.png}
\label{fig:influ2_read}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa2_randread.png}
\label{fig:influ2_randread}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa2_randwrite.png}
\label{fig:influ2_randwrite}
}
\label{fig:etapa2_influs}
\caption{Gráficos com as influências dos fatores calculadas para as operações avaliadas na Etapa 2: \subref{fig:influ2_write} - Escrita, \subref{fig:influ2_read} - Leitura, \subref{fig:influ2_randread} - Leitura aleatória e \subref{fig:influ2_randwrite} - Escrita aleatória}
\end{figure}


\section{Etapa 3: }\label{sec:etapa3}	

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|l|r|r|r|r|}
\hline
\multicolumn{1}{|l|}{\textbf{Fator(es)}} & \multicolumn{1}{l|}{\textbf{Write}} & \multicolumn{1}{l|}{\textbf{Read}} & \multicolumn{1}{l|}{\textbf{Random Read}} & \multicolumn{1}{l|}{\textbf{Random Write}} \\ \hline
\textbf{iA} & 94.36 & 14.81 & 0.74 & 0.08 \\ \hline
\textbf{iC} & 0.10 & 0.01 & 23.52 & 56.45 \\ \hline
\textbf{iD} & 3.19 & 64.68 & 69.60 & 43.08 \\ \hline
\textbf{iAC} & 0.63 & 5.26 & 0.01 & 0.14 \\ \hline
\textbf{iAD} & 1.40 & 14.35 & 0.88 & 0.01 \\ \hline
\textbf{iCD} & 0.22 & 0.88 & 4.80 & 0.25 \\ \hline
\textbf{iACD} & 0.09 & 0.00 & 0.45 & 0.00 \\ \hline
\end{tabular}
\caption{Tabela com os valores calculados de influência dos fatores para a Etapa 3 da avaliação de desempenho separados para o tipo de operação.}
\end{center}
\label{tab:influ3}
\end{table}


\begin{figure}[ht]
\centering
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa3_write.png}
\label{fig:influ3_write}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa3_read.png}
\label{fig:influ3_read}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa3_randread.png}
\label{fig:influ3_randread}
}
\subfigure[]{
\includegraphics[scale=0.8]{images/influencias/etapa3_randwrite.png}
\label{fig:influ3_randwrite}
}
\label{fig:etapa3_influs}
\caption{Gráficos com as influências dos fatores calculadas para as operações avaliadas na Etapa 3: \subref{fig:influ3_write} - Escrita, \subref{fig:influ3_read} - Leitura, \subref{fig:influ3_randread} - Leitura aleatória e \subref{fig:influ3_randwrite} - Escrita aleatória}
\end{figure}

	
\chapter{Conclusões}\label{cap:conclusao}

\section{Etapa 1:}\label{sec:etapa1conc}

\section{Etapa 2 }\label{sec:etapa2conc}

\section{Etapa 3 }\label{sec:etapa3conc}	

\section{Considerações finais}\label{sec:consideracoes}	
	
	
\bibliographystyle{abnt-num}
\bibliography{monografia}

\anexo
\chapter{Scripts utilizados}

\section{Execução dos experimentos}

\lstset{
	numbers=left,
	language=bash,
        basicstyle=\scriptsize,
        upquote=true,
        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=true,
        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        frame=single,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
	tabsize=1,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
	captionpos=b,
	caption={Script bash utilizado para execução dos experimentos. Foi executado uma vez com a máquina com 2GB de memória RAM e outra com 1GB de memória RAM.}
}
\lstinputlisting{include/execute.sh}


\section{Extração dos dados do log}

\lstset{
	captionpos=b,
	caption={Script bash utilizado para extrair os dados dos log dos experimentos para um formato separado por vírgulas que possibilitava a importação para uma planilha do OpenOffice.}
}
\lstinputlisting{include/extract.sh}

\section{Geração dos gráficos de barra}

\lstset{
	numbers=left,
	language=Gnuplot,
        basicstyle=\scriptsize,
        upquote=true,
        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=true,
        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        frame=single,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
	tabsize=1,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
	captionpos=b,
	caption={Script do Gnuplot utilizado gerar os gráficos de barra para comparação dos exeperimentos. Ele utiliza arquivos de dados que foram extraídos das tabelas que podem ser vistas no Anexo \ref{chap:dados}}
}
\lstinputlisting{include/plot.gp}

\chapter{Dados coletados}
\label{chap:dados}

\section{Ext4}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_1.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_2.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_3.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_4.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_5.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_6.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_7.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/ext4_8.png}
\end{center}
\end{figure}

\clearpage

\section{XFS}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_1.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_2.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_3.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_4.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_5.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_6.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_7.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/xfs_8.png}
\end{center}
\end{figure}

\clearpage

\section{ReiserFS}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/reiser_1.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/reiser_2.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/reiser_3.png}
\end{center}
\end{figure}

\begin{figure} [!ht]
\begin{center}
\includegraphics[width=1\textwidth]{images/dados/reiser_4.png}
\end{center}
\end{figure}

\clearpage

\end{document}